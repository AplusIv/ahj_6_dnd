{"version":3,"file":"main.js","mappings":"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","sources":["webpack://ahj_6_dnd/./src/js/TaskManager.js","webpack://ahj_6_dnd/./src/js/app.js"],"sourcesContent":["export default class TaskManager {\n  constructor(element) {\n    this.element = element;\n\n    this.draggedElement = null;\n    this.noteClosingElement = null;\n\n    this.element.addEventListener('click', TaskManager.onOpenNote);\n\n    this.element.addEventListener('click', TaskManager.OnAddTask);\n\n    // this.onCloseNote = this.onCloseNote.bind(this);\n    this.element.addEventListener('click', TaskManager.onCloseNote);\n\n    this.noteOnMouseDown = this.noteOnMouseDown.bind(this);\n\n    this.noteOnMouseMove = this.noteOnMouseMove.bind(this);\n    this.element.addEventListener('mousemove', this.noteOnMouseMove);\n\n    this.noteOnMouseUp = this.noteOnMouseUp.bind(this);\n    this.element.addEventListener('mouseup', this.noteOnMouseUp);\n\n    this.onMouseOver = this.onMouseOver.bind(this);\n    this.element.addEventListener('mouseover', this.onMouseOver);\n\n    this.onMouseOut = this.onMouseOut.bind(this);\n    this.element.addEventListener('mouseout', this.onMouseOut);\n  }\n\n  static get markup() {\n    return `\n    <div class=\"column\">\n      <div class=\"column-data\">\n        <div class=\"title\" name=\"todo\">todo</div>\n        <div class=\"content\">\n          <div class=\"note-wrapper\">\n            <div class=\"note\">Научиться тайм-менеджменту</div>\n          </div>\n        </div>\n      </div>\n      <div class=\"add-note\">\n        <button name=\"open-note-content\" class=\"open-note-content\" type=\"button\">Add another card</button>\n        <div class=\"new-note-content hidden\">\n          <textarea name=\"new-note\" class=\"textarea-new\" rows=\"5\" placeholder=\"Введите текст новой заметки\"\n            required></textarea>\n          <button name=\"add-button\" class=\"add-button\" type=\"button\">Add card</button>\n        </div>\n      </div>\n    </div>\n    <div class=\"column\">\n      <div class=\"column-data\">\n        <div class=\"title\" name=\"in progress\">in progress</div>\n        <div class=\"content\">\n          <div class=\"note-wrapper\">\n            <div class=\"note\">Выучиться на веб-разработчика</div>\n          </div>\n        </div>\n      </div>\n      <div class=\"add-note\">\n        <button name=\"open-note-content\" class=\"open-note-content\" type=\"button\">Add another card</button>\n        <div class=\"new-note-content hidden\">\n          <textarea name=\"new-note\" class=\"textarea-new\" rows=\"5\" placeholder=\"Введите текст новой заметки\"\n            required></textarea>\n          <button name=\"add-button\" class=\"add-button\" type=\"button\">Add card</button>\n        </div>\n      </div>\n    </div>\n    <div class=\"column\">\n      <div class=\"column-data\">\n        <div class=\"title\" name=\"done\">done</div>\n        <div class=\"content\">\n          <div class=\"note-wrapper\">\n            <div class=\"note\">Помыть посуду</div>\n          </div>\n          <div class=\"note-wrapper\">\n            <div class=\"note\">Погулять</div>\n          </div>\n          <div class=\"note-wrapper\">\n            <div class=\"note\">Сходить в магазин</div>\n          </div>\n        </div>\n      </div>\n      <div class=\"add-note\">\n        <button name=\"open-note-content\" class=\"open-note-content\" type=\"button\">Add another card</button>\n        <div class=\"new-note-content hidden\">\n          <textarea name=\"new-note\" class=\"textarea-new\" rows=\"5\" placeholder=\"Введите текст новой заметки\"\n            required></textarea>\n          <button name=\"add-button\" class=\"add-button\" type=\"button\">Add card</button>\n        </div>\n      </div>        \n    </div>\n    `;\n  }\n\n  static get closingElement() {\n    const closingElement = document.createElement('div');\n    closingElement.classList.add('close', 'hidden');\n    return closingElement;\n  }\n\n  bindToDom() {\n    this.element.innerHTML = TaskManager.markup;\n\n    this.noteClosingElement = TaskManager.closingElement;\n\n    this.contents = this.element.querySelectorAll('.content');\n\n    this.contents.forEach((content) => {\n      content.addEventListener('mousedown', this.noteOnMouseDown);\n    });\n  }\n\n  static onOpenNote(e) {\n    e.preventDefault();\n    if (e.target.classList.contains('open-note-content')) {\n      e.target\n        .closest('.add-note')\n        .querySelector('.new-note-content')\n        .classList.toggle('hidden');\n\n      e.target.closest('.add-note').querySelector('textarea').focus();\n\n      e.target.classList.toggle('hidden');\n    }\n  }\n\n  static OnAddTask(e) {\n    e.preventDefault();\n\n    if (e.target.classList.contains('add-button')) {\n      const textarea = e.target.parentElement.querySelector('textarea');\n      const { value } = textarea; // без переносов строки\n      if (value) {\n        e.target\n          .closest('.column')\n          .querySelector('.content')\n          .appendChild(TaskManager.newNote(value));\n        textarea.value = '';\n\n        e.target\n          .closest('.add-note')\n          .querySelector('.open-note-content')\n          .classList.toggle('hidden');\n        e.target.parentElement.classList.toggle('hidden');\n      }\n    }\n  }\n\n  static newNote(value) {\n    const wrapper = document.createElement('div');\n    wrapper.classList.add('note-wrapper');\n\n    const note = document.createElement('div');\n    note.classList.add('note');\n    note.textContent = value;\n\n    wrapper.appendChild(note);\n    return wrapper;\n  }\n\n  onMouseOver(e) {\n    if (e.target.classList.contains('note')) {\n      e.target.dataset.closing = 'possible';\n      this.showCLosingElement(e.target);\n\n      const { width, height } = e.target.getBoundingClientRect();\n      this.width = width;\n      this.height = height;\n    }\n  }\n\n  onMouseOut(e) {\n    if (e.target.classList.contains('note')) {\n      if (e.relatedTarget.classList.contains('close')) {\n        // если перешёл на закрывающий элемент, продолжить его отображение\n        this.showCLosingElement(e.target);\n      } else {\n        this.hideCLosingElement();\n        delete e.target.dataset.closing;\n      }\n    }\n  }\n\n  static onCloseNote(e) {\n    if (e.target.classList.contains('close')) {\n      e.target.parentElement.remove();\n    }\n  }\n\n  showCLosingElement(element) {\n    element.closest('.note-wrapper').appendChild(this.noteClosingElement);\n\n    const closingElement = document.querySelector('.close');\n    closingElement.classList.remove('hidden');\n\n    element.parentElement.appendChild(closingElement);\n\n    const { right, top } = element.getBoundingClientRect();\n\n    closingElement.style.top = `${top + 5}px`;\n    closingElement.style.left = `${right - 20}px`;\n  }\n\n  hideCLosingElement() {\n    const closingElement = document.querySelector('.close');\n    closingElement.remove();\n    this.noteClosingElement.classList.add('hidden');\n  }\n\n  noteOnMouseDown(e) {\n    e.preventDefault();\n\n    if (e.target.classList.contains('note')) {\n      this.draggedElement = e.target.closest('.note-wrapper');\n      this.draggedElement.classList.add('dragged');\n\n      // this.draggedElement.style.cursor = 'grabbing';\n\n      // shifts\n      this.shiftX = e.clientX - e.target.getBoundingClientRect().left;\n      this.shiftY = e.clientY - e.target.getBoundingClientRect().top;\n\n      // сохранение первоначальных размеров\n      this.draggedElement.style.width = `${this.width}px`;\n      this.draggedElement.style.height = `${this.height}px`;\n\n      this.proection = TaskManager.creatProection(this.draggedElement); // добавление проекции перетягиваемого элемента\n\n      document.documentElement.addEventListener('mouseup', this.noteOnMouseUp); // documentElement - корневой элемент\n      document.documentElement.addEventListener(\n        'mousemove',\n        this.noteOnMouseMove\n      );\n    }\n  }\n\n  noteOnMouseMove(e) {\n    e.preventDefault();\n\n    if (this.draggedElement) {\n      // this.draggedElement.style.cursor = 'grabbing';\n\n      this.draggedElement.style.width = `${this.width}px`;\n      this.draggedElement.style.height = `${this.height}px`;\n\n      this.draggedElement.style.top = `${e.clientY - this.shiftY}px`;\n      this.draggedElement.style.left = `${e.clientX - this.shiftX}px`;\n\n      TaskManager.definePlace(e, this.proection, e.target);\n    }\n  }\n\n  noteOnMouseUp(e) {\n    e.preventDefault();\n\n    if (this.draggedElement) {\n      // Определяю порядок вставки элемента: до или после.\n      const { y, height } = e.target.getBoundingClientRect();\n\n      const appendPosition =\n        y + height / 2 > e.clientY ? 'beforebegin' : 'afterend';\n\n      if (e.target.classList.contains('note')) {\n        e.target.parentElement.insertAdjacentElement(\n          appendPosition,\n          this.draggedElement\n        );\n      }\n      if (e.target.classList.contains('proection')) {\n        e.target.insertAdjacentElement(appendPosition, this.draggedElement);\n      }\n      if (e.target.classList.contains('column')) {\n        e.target.querySelector('.content').appendChild(this.draggedElement);\n      }\n\n      this.proection.remove();\n      this.proection = null;\n\n      // Убираем стили, которые навесили при перетаскивании элемента\n      this.draggedElement.style.cssText = `\n        cursor = \"\";\n        width = \"\";\n        height = \"\";\n        top = \"\";\n        left = \"\";\n      `;\n\n      this.draggedElement.classList.remove('dragged');\n      this.draggedElement = undefined;\n\n      document.documentElement.removeEventListener(\n        'mouseup',\n        this.noteOnMouseUp\n      ); // documentElement - корневой элемент\n      document.documentElement.removeEventListener(\n        'mouseover',\n        this.noteOnMouseMove\n      );\n    }\n  }\n\n  static definePlace(e, element, mouseUpElement) {\n    if (mouseUpElement.classList.contains('note')) {\n      // Определяю порядок вставки элемента: до или после.\n      const { y, height } = e.target.getBoundingClientRect();\n\n      const appendPosition =\n        y + height / 2 > e.clientY ? 'beforebegin' : 'afterend';\n\n      mouseUpElement.parentElement.insertAdjacentElement(\n        appendPosition,\n        element\n      );\n    }\n  }\n\n  static creatProection(draggedElement) {\n    return (() => {\n      const d = document.createElement('div');\n      d.classList.add('proection');\n      const { width, height } = window.getComputedStyle(draggedElement);\n      d.style.cssText = `\n\t \t\t\twidth: ${width};\n\t\t \t\theight: ${height};\n\t\t\t`;\n      return d;\n    })();\n  }\n}\n","import TaskManager from './TaskManager';\n\nconst container = document.querySelector('.container');\n\nconst taskManager = new TaskManager(container);\n\ntaskManager.bindToDom();\n\nwindow.addEventListener('beforeunload', () => {\n  if (document.querySelector('.close')) {\n    document.querySelector('.close').remove();\n  }\n\n  const storageData = [];\n  const contentData = document.querySelectorAll('.column');\n  contentData.forEach((data) => {\n    const key = data.querySelector('.title').textContent;\n    const value = data.querySelector('.content').innerHTML;\n    storageData.push({ [key]: value });\n  });\n\n  localStorage.setItem('storageData', JSON.stringify(storageData));\n});\n\nwindow.addEventListener('DOMContentLoaded', () => {\n  if (localStorage.getItem('storageData')) {\n    const jsonData = localStorage.getItem('storageData');\n    let dataArray;\n\n    try {\n      dataArray = JSON.parse(jsonData);\n    } catch (error) {\n      console.log(error);\n    }\n\n    dataArray.forEach((data) => {\n      const key = Object.keys(data)[0];\n      const value = Object.values(data)[0];\n\n      const titleElement = document.querySelector(`[name=\"${key}\"]`);\n      titleElement.closest('.column').querySelector('.content').innerHTML =\n        value;\n    });\n  }\n});\n"],"names":["TaskManager","constructor","element","this","draggedElement","noteClosingElement","addEventListener","onOpenNote","OnAddTask","onCloseNote","noteOnMouseDown","bind","noteOnMouseMove","noteOnMouseUp","onMouseOver","onMouseOut","markup","closingElement","document","createElement","classList","add","bindToDom","innerHTML","contents","querySelectorAll","forEach","content","e","preventDefault","target","contains","closest","querySelector","toggle","focus","textarea","parentElement","value","appendChild","newNote","wrapper","note","textContent","dataset","closing","showCLosingElement","width","height","getBoundingClientRect","relatedTarget","hideCLosingElement","remove","right","top","style","left","shiftX","clientX","shiftY","clientY","proection","creatProection","documentElement","definePlace","y","appendPosition","insertAdjacentElement","cssText","undefined","removeEventListener","mouseUpElement","d","window","getComputedStyle","container","storageData","data","key","push","localStorage","setItem","JSON","stringify","getItem","jsonData","dataArray","parse","error","console","log","Object","keys","values"],"sourceRoot":""}